<!--
    io7-hub setting node
-->
<script type="text/x-red" data-template-name="io7-hub">
    <div class="form-row">
        <label for="node-config-input-name" style="width:130px;"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name" style="width:300px">
    </div>
    <div class="form-row">
        <label for="node-config-input-apiKey" style="width:130px;"><i class="fa fa-user-secret"></i> API Key</label>
        <input type="text" id="node-config-input-apiKey" placeholder="API Key" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-config-input-apiToken" style="width:130px;"><i class="fa fa-key"></i> API Token</label>
        <input type="password" id="node-config-input-apiToken" placeholder="API Token" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-config-input-host" style="width:130px;"><i class="fa fa-server"></i> Host</label>
        <input type="text" id="node-config-input-host" placeholder="Host" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-config-input-useTLS" style="width:130px;">Use TLS</label>
        <input type="checkbox" id="node-config-input-useTLS" style="width:10px;">
    </div>
    <div class="form-row">
        <label for="node-config-input-port" style="width:130px;"><i class="fa fa-plug"></i> Port</label>
        <input type="checkbox" id="node-config-input-knownPort" style="width:10px;">
        <label for="node-config-input-knownPort" style="width:130px;">Well Known Port or </label>
        <input type="text" id="node-config-input-port" placeholder="Port" style="margin-left:50px;width:100px;" disabled>
    </div>
    <div class="form-row">
        <label for="node-config-row-tls" style="width:130px;"><i class="fa fa-certificate"></i> TLS Config</label>
        <span id="node-config-row-tls"><input style="width: 320px;" type="text" id="node-config-input-tls"></span>              
    </div>
    <div class="form-row">
        <label for="node-config-input-cliendid" style="width:130px;"><i class="fa fa-tag"></i> Client Id</label>
        <input type="text" id="node-config-input-clientid" placeholder="leave blank for 'io7_{auto generated}'" style="width:300px">
    </div>
</script>
<script type="text/x-red" data-help-name="io7-hub">
    <p>io7 IOT node</p>
</script>

<!--
    io7 in node
-->
<script type="text/x-red" data-template-name="io7 in">
    <div class="form-row">
        <label for="node-input-authentication" style="width:130px;"><i class="fa fa-lock"></i> Authentication</label>
        <input type="text" id="node-input-authentication" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-input-deviceId" style="width:130px;"><i class="fa fa-street-view"></i> Device Id</label>
        <input type="checkbox" id="node-input-allDevices" style="width:10px;">
        <label for="node-input-allDevicesLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-deviceId" placeholder="device id e.g. client123" style="width:240px;" disabled>
    </div>

    <div class="form-row">
        <label for="node-input-evt" style="width:130px;"><i class="fa fa-tasks"></i> Event</label>
        <input type="checkbox" id="node-input-allEvents" style="width:10px;" >
        <label for="node-input-allEventsLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-evt" placeholder="event type e.g. status" style="width:240px;" disabled>
    </div>
    <div class="form-row">
        <label for="node-input-fmt" style="width:130px;"><i class="fa fa-file"></i> Format</label>
        <input type="checkbox" id="node-input-allFormats" style="width:10px;" >
        <label for="node-input-allFormatsLabel" style="width:40px;">All or </label>
        <input type="text" id="node-input-fmt" placeholder="format e.g. json" style="width:240px;">
    </div>
    <div class="form-row">
        <label for="node-input-qos" style="width:130px;"><i class="fa fa-empire"></i> QoS</label>
        <select id="node-input-qos" style="width:70px" value="0">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width:130px;"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:300px">
    </div>
    <div class="form-tips">
        io7 IOT In node<br/>
    </div>
</script>
<script type="text/x-red" data-help-name="io7 in">
    <p>io7 IOT In node</p>
</script>

<!--
    io7 out node
-->
<script type="text/x-red" data-template-name="io7 out">
    <div class="form-row">
        <label for="node-input-authentication" style="width:130px;"><i class="fa fa-lock"></i> Authentication</label>
        <input type="text" id="node-input-authentication" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-input-deviceId" style="width:130px;"><i class="fa fa-street-view"></i> Device Id</label>
        <input type="text" id="node-input-deviceId" style="width:300px;" placeholder="Device Id">
    </div>
    <div class="form-row">
        <label for="node-input-cmd" style="width:130px;"><i class="fa fa-legal"></i> Command Type</label>
        <input type="text" id="node-input-cmd" placeholder="power" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-input-fmt" style="width:130px;"><i class="fa fa-file"></i> Format</label>
        <input type="text" id="node-input-fmt" placeholder="format e.g. json" style="width:300px;">
    </div>
    <div class="form-row">
        <label for="node-input-qos" style="width:130px;"><i class="fa fa-empire"></i> QoS</label>
        <select id="node-input-qos" style="width:70px" value="0">
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </select>
        <label for="node-input-retain" class="icon-tag" style="margin-left:50px;width:80px;"><i class="fa fa-history"></i> Retain</label>
        <select id="node-input-retain" style="width:90px" >
            <option value=""></option>
            <option value="false">false</option>
            <option value="true">true</option>
        </select>
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width:130px;"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name" style="width:300px;">
    </div>
    <div class="form-tips">
        io7 IOT Out node<br/>
    </div>
</script>
<script type="text/x-red" data-help-name="io7 out">
    <p>io7 IOT Out node</p>
</script>


<!--
    io7 hub/in/out node registration
-->
<script type="text/javascript">

    RED.nodes.registerType('io7-hub',{
        category: 'config',
        defaults: {
            name: {value:""},
            host: {value:"mqtt"},
            useTLS: {value:false},
            knownPort: {value:true},
            port: {value:"1883"},
            tls: {type:"tls-config",required: false,
                  label:RED._("node-red:mqtt.label.use-tls") },
            clientid: {value:""}
        },
        credentials: {
            apiKey: {type:"text"},
            apiToken: {type: "password"}
        },
        icon: "memory.png",
        label: function() {
            return this.name||"io7-hub";
        },
        oneditprepare: function () {
            $("#node-config-input-knownPort").change(function () {
                if ($("#node-config-input-knownPort").is(":checked")) {
                    $("#node-config-input-port").prop("disabled", true);
                } else {
                    $("#node-config-input-port").prop("disabled", false);
                }
            });
        }
    });

    RED.nodes.registerType('io7 in',{
        category: 'io7',
        color: 'rgb(255,165,0)',
        defaults: {
            name: {value:""},
            deviceId: {value:"+", required:true},
            authentication: {type:"io7-hub", required:true},
            evt: {value:"+"},
            fmt: {value:"json"},
            qos: {value:"0"},
            allDevices: {value: true},
            allEvents: {value: true},
            allFormats: {value: false},
        },
        inputs:0,
        outputs:1,
        icon: "memory.png",
        label: function() {
            return this.name||"io7 in";
        },
        oneditprepare: function () {
            $("#node-input-allDevices").change(function () {
                if ($("#node-input-allDevices").is(":checked")) {
                    $("#node-input-deviceId").prop("disabled", true);
                } else {
                    $("#node-input-deviceId").prop("disabled", false);
                }
            });
            $("#node-input-allEvents").change(function () {
                if ($("#node-input-allEvents").is(":checked")) {
                    $("#node-input-evt").prop("disabled", true);
                } else {
                    $("#node-input-evt").prop("disabled", false);
                }
            });
            $("#node-input-allFormats").change(function () {
                if ($("#node-input-allFormats").is(":checked")) {
                    $("#node-input-fmt").prop("disabled", true);
                } else {
                    $("#node-input-fmt").prop("disabled", false);
                }
            });
        }
    });

    RED.nodes.registerType('io7 out',{
        category: 'io7',
        color: 'rgb(255,165,0)',
        defaults: {
            authentication: {type:"io7-hub", required:true},
            name: {value:""},
            deviceId: {value:"", required:true},
            cmd: {value:""},
            fmt: {value:"json"},
            qos: {value:"0"},
            retain: {value:"false"}
        },
        inputs:1,
        outputs:0,
        icon: "memory.png",
        label: function() {
            return this.name||"io7 out";
        }
    });

</script>
